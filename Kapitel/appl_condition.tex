\section{Consistency-Maintaining and Increasing Application Conditions}\label{appl_conds}

\input{figures/fig_rules}
\input{figures/fig_appl_cond}

In the following, we present application conditions which ensure that every rule equipped with this application condition is (direct) consistency-increasing at layer, (direct) con\-sis\-ten\-cy-maintaining at layer or (direct) consistency-maintaining.
In particular, we present application conditions in the general case and for specific rules, called  \emph{basic increasing} rules.
For basic rules, less complex application conditions can be constructed.
Similar to the notions of consistency-maintaining and consistency-increasing, these application conditions will only consider graphs of the constraint up to a certain layer  and we will show that rules equipped with these application conditions are direct consistency-maintaining and direct consistency-increasing rules at layer, respectively.  

%This is useful to reduce the restrictiveness and complexity of these application conditions, since all graphs $C_j$ with $j > \kmax +2 $ do not affect whether a transformation is consistency-maintaining or consistency-increasing.
%Since not all graphs of a constraint is considered, it is clear that rules equipped with these application conditions are not consistency-maintaining or consistency increasing rules. 
%For example, a transformation $t: G \Longrightarrow H$ with $G \models_{\kmax} c$ via a rule equipped with a application condition that only considers the graphs $C_i$ with $0 \leq i < j < \kmax < \nlvl(c)$ must not necessarily be consistency-increasing w.r.t. $c$.  





\input{Kapitel/application_conditions/general_ap}
\input{Kapitel/application_conditions/basic_rules}
\input{Kapitel/application_conditions/basic_ap}


%
%\begin{definition}[\textbf{overlap shift}]
%Let $\rho = L \xhookleftarrow{} K \xhookrightarrow{} R$ be a plain rule, $C$ a graph and $C'$ an overlap of $C$ and $L$ with morphisms $p : L \inj C'$, $k: K \inj C'$, $c:C \inj C'$ and the partial morphism $q: R \inj C'$. 
%We define 
%\begin{equation}
%\begin{split}
%	D := \{e \in C' \mid &(\exists e' \in L: p(e') = e \\ &\vee \exists e' \in R: q(e') = e) \\ &\wedge \exists e' \in C: c(e') = e \}
%\end{split}
%\end{equation}
%Let $r = L \xhookleftarrow{} K' \xhookrightarrow{} R$ be the rule with 
%$$K' := K \cup D$$
%The graph $H$ derived by the transformation $G \Rightarrow_{r,p} H$ is called the \emph{overlap shifted graph of $C'$ with $C$ and  $\rho$}.
%The overlap shifted graph of an graph $C$ is denoted by $\ols_{\rho}(C,C')$.
%\end{definition} 




%\begin{lemma}
%Let $G$ be a graph, $c$ a constraint in EANF, with $\maxc{G} < \nlvl(c)-1$,  and $\rho = L \xhookleftarrow{} K \xhookrightarrow{} R$ a plain rule.
%Let $d = \forall(a_k : C_{k-1} \inj C_{k}, \exists(b: C_{k} \inj C_{k+1}, e))$ be the subcondition of $c$ at layer $\cmax + 1$ and $\ap(\maxc{G} + 1, C')$ the application condition constructed by definition \ref{def_appl_cond} with $C'\in \mathcal{U}(C, C_{k+1})$.
%If 
%$$((R \setminus K) \cap C_{k+1}) \cup ((L \setminus K) \cap C_{k+1}) = \emptyset$$
%$\ap(\cmax, C')$ can be replaced by $\false$. 
%\end{lemma}
%\begin{proof}
%There does not exist an overlap $P$ of $C_k$ and $L$ with $i_L(L \setminus K) \cap i_{C_k}(C_k) \neq \emptyset$ and $\rep(P,C')$ will be equal to $\false$, if $C_k = C_{k+1}$, or equal to $\bigvee_{P' \in \mathbf{P}} \shift(\exists(i_R: R \inj P', \true), \rho)$. 
%Since the set $\mathbf{P}$ has to be empty, this expression can be replaced by $\false$. 
%If follows that $\rep(P,C') = \false$ for all $P \in \overlay(L,C_k)$ and therefore $\ap(\cmax, C')$ will always be evaluated to $\false$.
%\end{proof}

\input{Kapitel/pot_improving_rules}
